@import "tailwindcss";

/* 
   合并 daisyUI 配置。
   在 Tailwind CSS 4 中，只需调用一次 @plugin "daisyui"。
   通过 themes: light --default 显式指定默认主题，并避免加载默认的 dark 主题颜色。
*/
@plugin "daisyui" {
  themes: light --default;
}

/* 
   使用 Tailwind CSS 4 的 @theme 块定义主题变量。
   这里的变量会自动映射为 Tailwind 的实用类（如 bg-primary, text-mtga-accent）。
*/
@theme {
  /* 
     在 Tailwind CSS 4 中定义主题颜色。
     直接使用颜色值，确保 Tailwind 的实用类（如 bg-primary）能正确生成。
  */
  --color-primary: #f0bb32;
  --color-primary-content: #1e293b;

  /* 品牌色变量定义，供 Tailwind 实用类使用（如 text-mtga-accent） */
  --color-mtga-bg: #f7f8fb;
  --color-mtga-surface: #ffffff;
  --color-mtga-surface-soft: #f3f6fa;
  --color-mtga-border: #e5e7eb;
  --color-mtga-accent: #f0bb32;
  --color-mtga-accent-strong: #d9a307;
  --color-mtga-warn: #f59e0b;
  --color-mtga-text: #0f172a;
  --color-mtga-text-muted: #64748b;
}

@layer base {
  /* 
     显式覆盖 daisyUI 注入的主题变量。
     通过 :root 和 [data-theme] 确保在任何模式（浅色/深色）下都能强制生效。
  */
  :root, [data-theme] {
    --color-primary: #f0bb32 !important;
    --color-primary-content: #1e293b !important;

    /* 同时也定义一份 CSS 变量，供非 Tailwind 样式（如 scrollbar）通过 var() 引用 */
    --mtga-bg: #f7f8fb;
    --mtga-surface: #ffffff;
    --mtga-surface-soft: #f3f6fa;
    --mtga-border: #e5e7eb;
    --mtga-accent: #f0bb32;
    --mtga-accent-strong: #d9a307;
    --mtga-warn: #f59e0b;
    --mtga-text: #0f172a;
    --mtga-text-muted: #64748b;
  }
  /* 自定义全局滚动条样式 */
  ::-webkit-scrollbar {
    width: 6px;
    height: 6px;
  }

  ::-webkit-scrollbar-track {
    background: transparent;
  }

  ::-webkit-scrollbar-thumb {
    background: var(--mtga-border); /* 使用定义的边框颜色作为默认色 */
    border-radius: 10px;
    border: 1px solid transparent; /* 增加一点内边距效果 */
    background-clip: padding-box;
    transition: background 0.2s ease;
  }

  ::-webkit-scrollbar-thumb:hover {
    background: var(--mtga-accent); /* 悬停时使用品牌色 */
    border: 1px solid transparent;
    background-clip: padding-box;
  }

  /* 针对 Firefox 的兼容性 */
  * {
    scrollbar-width: thin;
    scrollbar-color: var(--mtga-border) transparent;
  }

  body {
    background-color: var(--mtga-bg);
    background-image:
      /* 左上角：琥珀金光晕，增强温暖感 */
      radial-gradient(circle at 15% 15%, rgba(251, 191, 36, 0.15), transparent 50%),
      /* 右下角：极淡的夕阳粉，增加层次感 */
      radial-gradient(circle at 85% 85%, rgba(251, 113, 133, 0.05), transparent 40%),
      /* 基础线性渐变：以 #fffbeb 为核心的暖色调过渡 */
      linear-gradient(135deg, #fffbeb 0%, #fff9e6 45%, #fff2e0 100%);
    color: var(--mtga-text);
  }
}

  /* 
     MTGA 通用按钮样式
     封装了项目中频繁使用的三种按钮规格
  */
  
  /* 1. 品牌色主按钮 (Primary) */
  @utility mtga-btn-primary {
    @apply btn btn-primary btn-sm w-full rounded-xl shadow-sm;
  }

  /* 2. 危险/停止操作按钮 (Error Outline) */
  @utility mtga-btn-error {
    @apply btn btn-outline btn-sm rounded-xl border-slate-200 text-error hover:bg-error/10 hover:border-error w-full;
  }

  /* 3. 次要/检查操作按钮 (Outline with Amber hover) */
  @utility mtga-btn-outline {
    @apply btn btn-outline btn-sm rounded-xl border-slate-200 hover:border-amber-500 hover:bg-amber-50/50 hover:text-amber-600 w-full;
  }

@layer components {
  .mtga-card {
    @apply rounded-2xl border border-slate-200/70 bg-white/40 backdrop-blur-sm shadow-[0_18px_45px_-32px_rgba(15,23,42,0.2)];
  }

  .mtga-card-body {
    @apply p-5;
  }

  .mtga-card-title {
    @apply text-base font-semibold tracking-tight text-slate-900;
  }

  .mtga-card-subtitle {
    @apply text-xs text-slate-500;
  }

  .mtga-chip {
    @apply inline-flex items-center gap-2 rounded-full border border-slate-200/80 bg-white/30 px-3 py-1 text-xs text-slate-600 shadow-sm;
  }

  .mtga-soft-panel {
    @apply rounded-xl border border-slate-200/80 p-3;
  }

  /**
   * 用于点击的长条形子样式
   * 继承自 mtga-soft-panel 的基础样式，具有较小的高度和全宽
   */
  .mtga-clickable-row {
    @apply mtga-btn-outline flex h-auto items-center justify-between px-4 py-2 text-sm transition-all active:scale-[0.98];
  }

  .mtga-clickable-row::after {
    content: "›";
    @apply ml-2 text-slate-400 font-bold text-lg leading-none;
  }

  /* 
     mtga-tooltip 基础定义
     我们保留原生 tooltip 类以支持 daisyUI 的基础样式（如 cursor），
     但通过全局代理元素来渲染实际的提示框，以逃逸 overflow: hidden。
  */
  .mtga-tooltip {
    position: relative;
    z-index: 30;
  }

  /* 隐藏原生的 daisyUI tooltip 伪元素，改用全局代理 */
  .mtga-tooltip::before,
  .mtga-tooltip::after {
    display: none !important;
  }

  /* 全局 Tooltip 代理样式 */
  .mtga-tooltip-proxy {
    position: fixed;
    z-index: 9999;
    pointer-events: none;
    
    /* 基础视觉样式：匹配按钮悬停态与品牌色 */
    background-color: #fffbeb; /* amber-50 */
    color: var(--mtga-text);
    border: 1px solid var(--mtga-accent); /* 使用品牌金黄色 */
    padding: 0.5rem 0.75rem;
    border-radius: 0.75rem; /* 匹配按钮的 rounded-xl */
    font-size: 0.75rem;
    font-weight: 500;
    line-height: 1.25rem;
    box-shadow: 0 10px 15px -3px rgba(240, 187, 50, 0.2); /* 带有品牌色的阴影 */
    white-space: pre-line;
    text-align: left;
    word-break: break-all;
    max-width: var(--mtga-tooltip-max, 280px);

    /* 动画效果 */
    animation: mtga-tooltip-in 0.15s ease-out forwards;
    
    /* 居中偏移量 */
    translate: -50% 0;

    /* 锚点定位核心 */
    @supports (anchor-name: --test) {
      position-anchor: --mtga-tooltip-anchor;
      bottom: calc(anchor(top) + 10px);
      left: anchor(center);
      top: auto;
    }
  }

  /* 代理元素的箭头 */
  .mtga-tooltip-proxy::after {
    content: "";
    position: absolute;
    bottom: -5px; /* 微调位置以对齐边框 */
    left: 50%;
    translate: -50% 0;
    width: 8px;
    height: 8px;
    background-color: #fffbeb;
    border-right: 1px solid var(--mtga-accent);
    border-bottom: 1px solid var(--mtga-accent);
    transform: rotate(45deg);
  }

  @keyframes mtga-tooltip-in {
    from { opacity: 0; transform: scale(0.95) translateY(4px); }
    to { opacity: 1; transform: scale(1) translateY(0); }
  }
}
